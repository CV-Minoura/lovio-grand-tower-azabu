---
// Floating CTA Component
// スクロール100vh後に右下に出現
---

<div id="floating-cta" class="fixed right-6 bottom-6 z-[900] opacity-0 translate-y-4 pointer-events-none">
  <a
    href="#contact"
    class="floating-cta-button flex items-center gap-3 px-6 py-4 bg-accent-gold text-background font-sans text-sm font-medium tracking-wider hover:bg-accent-light transition-all duration-300 shadow-lg hover:shadow-xl"
  >
    <span>CONTACT</span>
    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
    </svg>
  </a>
</div>

<script>
  import { gsap } from 'gsap';
  import { ScrollTrigger } from 'gsap/ScrollTrigger';

  gsap.registerPlugin(ScrollTrigger);

  const initFloatingCta = () => {
    const floatingCta = document.getElementById('floating-cta');

    if (!floatingCta) return;

    ScrollTrigger.create({
      trigger: 'body',
      start: 'top top-=100vh',
      onEnter: () => {
        gsap.to(floatingCta, {
          opacity: 1,
          y: 0,
          duration: 0.5,
          ease: 'power2.out'
        });
        floatingCta.classList.remove('pointer-events-none');
      },
      onLeaveBack: () => {
        gsap.to(floatingCta, {
          opacity: 0,
          y: 16,
          duration: 0.3,
          ease: 'power2.in'
        });
        floatingCta.classList.add('pointer-events-none');
      }
    });

    // Hide when near footer/contact section
    const contactSection = document.getElementById('contact');
    if (contactSection) {
      ScrollTrigger.create({
        trigger: contactSection,
        start: 'top bottom-=100',
        onEnter: () => {
          gsap.to(floatingCta, {
            opacity: 0,
            duration: 0.3
          });
        },
        onLeaveBack: () => {
          gsap.to(floatingCta, {
            opacity: 1,
            duration: 0.3
          });
        }
      });
    }
  };

  document.addEventListener('DOMContentLoaded', initFloatingCta);
</script>

<style>
  .floating-cta-button {
    will-change: transform, opacity;
  }

  .floating-cta-button:hover svg {
    transform: translateX(4px);
    transition: transform 0.3s ease;
  }
</style>
