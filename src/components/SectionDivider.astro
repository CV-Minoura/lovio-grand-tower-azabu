---
interface Props {
  variant?: 'line' | 'diamond' | 'dots';
}

const { variant = 'line' } = Astro.props;
---

{variant === 'line' && (
  <div class="section-divider section-divider-line relative h-px my-0 overflow-hidden">
    <div class="divider-line-left absolute top-0 left-0 h-full w-0 bg-gradient-to-r from-transparent via-accent-gold to-accent-gold"></div>
    <div class="divider-line-right absolute top-0 right-0 h-full w-0 bg-gradient-to-l from-transparent via-accent-gold to-accent-gold"></div>
  </div>
)}

{variant === 'diamond' && (
  <div class="section-divider section-divider-diamond relative flex items-center justify-center py-16">
    <div class="divider-line-left h-px w-0 bg-gradient-to-r from-transparent to-accent-gold/50"></div>
    <div class="divider-diamond w-3 h-3 bg-accent-gold rotate-45 mx-4 opacity-0 scale-0"></div>
    <div class="divider-line-right h-px w-0 bg-gradient-to-l from-transparent to-accent-gold/50"></div>
  </div>
)}

{variant === 'dots' && (
  <div class="section-divider section-divider-dots relative flex items-center justify-center gap-3 py-16">
    <div class="divider-dot w-1 h-1 bg-accent-gold/50 rounded-full opacity-0"></div>
    <div class="divider-dot w-1.5 h-1.5 bg-accent-gold rounded-full opacity-0"></div>
    <div class="divider-dot w-2 h-2 bg-accent-gold rounded-full opacity-0"></div>
    <div class="divider-dot w-1.5 h-1.5 bg-accent-gold rounded-full opacity-0"></div>
    <div class="divider-dot w-1 h-1 bg-accent-gold/50 rounded-full opacity-0"></div>
  </div>
)}

<script>
  import { gsap } from 'gsap';
  import { ScrollTrigger } from 'gsap/ScrollTrigger';

  gsap.registerPlugin(ScrollTrigger);

  const initDividers = () => {
    // Line dividers
    document.querySelectorAll('.section-divider-line').forEach(divider => {
      const left = divider.querySelector('.divider-line-left');
      const right = divider.querySelector('.divider-line-right');

      ScrollTrigger.create({
        trigger: divider,
        start: 'top 80%',
        onEnter: () => {
          gsap.to([left, right], {
            width: '50%',
            duration: 0.8,
            ease: 'power2.out'
          });
        }
      });
    });

    // Diamond dividers
    document.querySelectorAll('.section-divider-diamond').forEach(divider => {
      const left = divider.querySelector('.divider-line-left');
      const right = divider.querySelector('.divider-line-right');
      const diamond = divider.querySelector('.divider-diamond');

      ScrollTrigger.create({
        trigger: divider,
        start: 'top 80%',
        onEnter: () => {
          gsap.to(diamond, {
            opacity: 1,
            scale: 1,
            rotation: 45,
            duration: 0.5,
            ease: 'back.out(2)'
          });
          gsap.to([left, right], {
            width: '120px',
            duration: 0.6,
            delay: 0.2,
            ease: 'power2.out'
          });
        }
      });
    });

    // Dots dividers
    document.querySelectorAll('.section-divider-dots').forEach(divider => {
      const dots = divider.querySelectorAll('.divider-dot');

      ScrollTrigger.create({
        trigger: divider,
        start: 'top 80%',
        onEnter: () => {
          gsap.to(dots, {
            opacity: 1,
            scale: 1,
            duration: 0.4,
            stagger: 0.1,
            ease: 'back.out(2)'
          });
        }
      });
    });
  };

  document.addEventListener('DOMContentLoaded', initDividers);
</script>

<style>
  .divider-line-left,
  .divider-line-right {
    will-change: width;
  }

  .divider-diamond {
    will-change: transform, opacity;
  }

  .divider-dot {
    will-change: transform, opacity;
  }
</style>
